name: Archive to Web Archive

on:
  push:
    branches:
      - main
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  archive:
    runs-on: ubuntu-latest
    name: ä¿å­˜ç½‘ç«™åˆ°äº’è”ç½‘æ¡£æ¡ˆé¦†
    
    steps:
      - name: ç­‰å¾…éƒ¨ç½²å®Œæˆ
        run: |
          echo "ç­‰å¾… 60 ç§’ä»¥ç¡®ä¿ Vercel éƒ¨ç½²å®Œæˆ..."
          sleep 60
      
      - name: å‘é€å­˜æ¡£è¯·æ±‚åˆ° Web Archive
        run: |
          echo "æ­£åœ¨å‘ Web Archive å‘é€å­˜æ¡£è¯·æ±‚..."
          
          # å®šä¹‰è¦å­˜æ¡£çš„é¡µé¢åˆ—è¡¨
          PAGES=(
            "https://f1justin.com"
            "https://f1justin.com/#about"
            "https://f1justin.com/#contact"
          )
          
          # éå†æ¯ä¸ªé¡µé¢å¹¶å‘é€å­˜æ¡£è¯·æ±‚
          for page in "${PAGES[@]}"; do
            echo "ğŸ“¦ å­˜æ¡£é¡µé¢: $page"
            curl -X GET "https://web.archive.org/save/$page" \
              -H "User-Agent: Mozilla/5.0 (compatible; f1justin.com archiver)" \
              -w "\nçŠ¶æ€ç : %{http_code}\n" \
              --max-time 30 || true
            sleep 2  # é¿å…è¯·æ±‚è¿‡å¿«
          done
          
          echo ""
          echo "âœ… æ‰€æœ‰å­˜æ¡£è¯·æ±‚å·²å‘é€ï¼"
          echo "ğŸ“¦ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹å­˜æ¡£: https://web.archive.org/web/*/f1justin.com"
      
      - name: å­˜æ¡£å®Œæˆé€šçŸ¥
        run: |
          echo "âœ… ç½‘ç«™å·²æˆåŠŸæäº¤åˆ° Internet Archive"
          echo "ğŸ”— æŸ¥çœ‹å†å²å¿«ç…§: https://web.archive.org/web/*/f1justin.com"

